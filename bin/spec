#!/bin/bash

DEFAULT_FLAGS="-std=c2x -Wall -Werror -DPLATFORM=LINUX"
SPEC_FILES=$(find src/spec/ -type f | tr '\n' ' ')

gcc src/spec.c                  \
  src/ion/libraries.c           \
  $SPEC_FILES $DEFAULT_FLAGS    \
  -include src/ion.h            \
  -g3 -o exe/spec               &&
valgrind                        \
  --track-origins=yes           \
  --leak-check=full             \
  --show-leak-kinds=all         \
  exe/spec
echo
